{% extends "layout/base.html" %}

{% block title %}{{ usuario.nombres }} {{ usuario.apellidos }} - VOCES{% endblock %}

{% block content %}
<div class="min-h-screen bg-background">
    <div class="px-4 sm:px-10 lg:px-20 flex flex-1 justify-center py-5 sm:py-10">
        <div class="flex flex-col w-full max-w-[960px] flex-1">
            <!-- Botón Volver -->
            <div class="mb-6">
                <a href="/usuarios"
                    class="inline-flex items-center text-sm text-muted-foreground hover:text-foreground transition-colors">
                    <span class="material-symbols-outlined text-base mr-1">arrow_back</span>
                    Volver al listado
                </a>
            </div>

            <!-- Card Principal del Perfil -->
            <div class="flex flex-col gap-8 rounded-xl bg-card border border-border shadow-sm p-4 sm:p-6 md:p-8">

                <!-- Header: Avatar, Nombre y Botones -->
                <!-- Nombre, Username, Badges y Bio -->
                <div class="flex flex-col justify-center gap-2">
                    <div class="flex flex-col sm:flex-row items-center gap-3">
                        <h1 class="text-foreground text-2xl sm:text-3xl font-bold leading-tight tracking-tight">
                            {{ usuario.nombres }} {{ usuario.apellidos }}
                        </h1>
                        <!-- Badges de Rol y Estado -->
                        <div class="flex gap-2 flex-wrap justify-center sm:justify-start">
                            <!-- Rol Badge -->
                            {% if usuario.rol.value == 'Admin' %}
                            <span
                                class="text-xs font-semibold inline-block py-1 px-2.5 uppercase rounded-full text-purple-600 bg-purple-200 dark:text-purple-300 dark:bg-purple-900/50">
                                Admin
                            </span>
                            {% elif usuario.rol.value == 'Moderador' %}
                            <span
                                class="text-xs font-semibold inline-block py-1 px-2.5 uppercase rounded-full text-blue-600 bg-blue-200 dark:text-blue-300 dark:bg-blue-900/50">
                                Moderador
                            </span>
                            {% elif usuario.rol.value == 'Editor' %}
                            <span
                                class="text-xs font-semibold inline-block py-1 px-2.5 uppercase rounded-full text-green-600 bg-green-200 dark:text-green-300 dark:bg-green-900/50">
                                Editor
                            </span>
                            {% else %}
                            <span
                                class="text-xs font-semibold inline-block py-1 px-2.5 uppercase rounded-full text-gray-600 bg-gray-200 dark:text-gray-300 dark:bg-gray-800">
                                Usuario
                            </span>
                            {% endif %}

                            <!-- Estado Badge -->
                            {% if usuario.estado_cuenta.value == 'Activo' %}
                            <span
                                class="text-xs font-semibold inline-block py-1 px-2.5 uppercase rounded-full text-green-600 bg-green-200 dark:text-green-300 dark:bg-green-900/50">
                                Activo
                            </span>
                            {% elif usuario.estado_cuenta.value == 'PendienteVerificacion' %}
                            <span
                                class="text-xs font-semibold inline-block py-1 px-2.5 uppercase rounded-full text-yellow-600 bg-yellow-200 dark:text-yellow-300 dark:bg-yellow-900/50">
                                Pendiente
                            </span>
                            {% endif %}
                        </div>
                    </div>
                    <p class="text-muted-foreground text-base font-normal leading-normal">
                        @{{ usuario.username }}
                    </p>
                    {% if usuario.biografia %}
                    <p class="text-foreground/80 text-base font-normal leading-normal max-w-md">
                        {{ usuario.biografia }}
                    </p>
                    {% endif %}
                </div>
            </div>

            <!-- Botones de Acción -->
            <div class="flex w-full sm:w-auto shrink-0 justify-center gap-3">
                <a href="/usuarios/{{ usuario.username }}/editar"
                    class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-accent text-accent-foreground text-sm font-bold leading-normal tracking-[0.015em] flex-1 sm:flex-auto hover:bg-accent/80 transition-colors">
                    <span class="truncate">Editar</span>
                </a>
                <form action="/usuarios/{{ usuario.username }}/eliminar" method="POST"
                    onsubmit="return confirm('¿Estás seguro de que deseas eliminar este usuario? Esta acción no se puede deshacer.');"
                    class="flex-1 sm:flex-auto">
                    <button type="submit"
                        class="w-full flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-destructive text-destructive-foreground text-sm font-bold leading-normal tracking-[0.015em] hover:bg-destructive/90 transition-colors">
                        <span class="truncate">Eliminar</span>
                    </button>
                </form>
            </div>
        </div>

        <!-- Tabs de Navegación -->
        <div class="pb-3">
            <div class="flex border-b border-border gap-2 sm:gap-8">
                <a class="flex flex-col items-center justify-center border-b-[3px] border-b-primary text-foreground pb-[13px] pt-4 px-2 sm:px-4"
                    href="#">
                    <p class="text-sm font-bold leading-normal tracking-[0.015em]">Información</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] border-b-transparent text-muted-foreground pb-[13px] pt-4 px-2 sm:px-4 hover:border-b-border hover:text-foreground transition-colors"
                    href="#">
                    <p class="text-sm font-bold leading-normal tracking-[0.015em]">Actividad</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] border-b-transparent text-muted-foreground pb-[13px] pt-4 px-2 sm:px-4 hover:border-b-border hover:text-foreground transition-colors"
                    href="#">
                    <p class="text-sm font-bold leading-normal tracking-[0.015em]">Estadísticas</p>
                </a>
            </div>
        </div>

        <!-- Grid de Contenido -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Columna Principal (2/3) -->
            <div class="md:col-span-2 flex flex-col gap-6">
                <!-- Información Personal -->
                <div class="flex flex-col gap-4 rounded-lg bg-card/50 border border-border/50 p-5">
                    <h2 class="text-foreground text-xl font-bold leading-tight tracking-tight flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary">person</span>
                        Información Personal
                    </h2>
                    <dl class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-foreground/80">
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">Email</dt>
                            <dd class="text-sm">{{ usuario.email }}</dd>
                        </div>
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">ID de Usuario</dt>
                            <dd class="text-sm font-mono">{{ usuario.id }}</dd>
                        </div>
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">Fecha de Registro</dt>
                            <dd class="text-sm">
                                {{ usuario.creado_en.strftime('%d de %B de %Y') if usuario.creado_en else 'N/A'
                                }}
                            </dd>
                        </div>
                        {% if usuario.actualizado_en %}
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">Última Actualización</dt>
                            <dd class="text-sm">
                                {{ usuario.actualizado_en.strftime('%d de %B de %Y') }}
                            </dd>
                        </div>
                        {% endif %}
                    </dl>
                </div>

                <!-- Datos Demográficos -->
                {% if usuario.perfil_demografico %}
                <div class="flex flex-col gap-4 rounded-lg bg-card/50 border border-border/50 p-5">
                    <h2 class="text-foreground text-xl font-bold leading-tight tracking-tight flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary">location_on</span>
                        Datos Demográficos
                    </h2>
                    <dl class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-foreground/80">
                        {% if usuario.perfil_demografico.ciudad or usuario.perfil_demografico.departamento %}
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">Ubicación</dt>
                            <dd class="text-sm">
                                {% if usuario.perfil_demografico.ciudad %}{{ usuario.perfil_demografico.ciudad
                                }}{% endif %}
                                {% if usuario.perfil_demografico.ciudad and
                                usuario.perfil_demografico.departamento %}, {% endif %}
                                {% if usuario.perfil_demografico.departamento %}{{
                                usuario.perfil_demografico.departamento }}{% endif %}
                            </dd>
                        </div>
                        {% endif %}
                        {% if usuario.perfil_demografico.telefono %}
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">Teléfono</dt>
                            <dd class="text-sm">{{ usuario.perfil_demografico.telefono }}</dd>
                        </div>
                        {% endif %}
                        {% if usuario.perfil_demografico.sexo %}
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">Sexo</dt>
                            <dd class="text-sm">
                                {% if usuario.perfil_demografico.sexo.value == 'M' %}Masculino
                                {% elif usuario.perfil_demografico.sexo.value == 'F' %}Femenino
                                {% elif usuario.perfil_demografico.sexo.value == 'O' %}Otro
                                {% else %}Prefiere no decir{% endif %}
                            </dd>
                        </div>
                        {% endif %}
                        {% if usuario.perfil_demografico.fecha_nacimiento %}
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">Fecha de Nacimiento</dt>
                            <dd class="text-sm">
                                {{ usuario.perfil_demografico.fecha_nacimiento.strftime('%d de %B de %Y') }}
                            </dd>
                        </div>
                        {% endif %}
                        {% if usuario.perfil_demografico.nivel_educativo %}
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">Nivel Educativo</dt>
                            <dd class="text-sm">{{ usuario.perfil_demografico.nivel_educativo }}</dd>
                        </div>
                        {% endif %}
                        {% if usuario.perfil_demografico.ocupacion %}
                        <div>
                            <dt class="text-sm font-medium text-muted-foreground mb-1">Ocupación</dt>
                            <dd class="text-sm">{{ usuario.perfil_demografico.ocupacion }}</dd>
                        </div>
                        {% endif %}
                    </dl>
                </div>
                {% endif %}
            </div>

            <!-- Columna Lateral (1/3) -->
            <div class="flex flex-col gap-6">
                <!-- Estadísticas -->
                <div class="flex flex-col gap-4 rounded-lg bg-card/50 border border-border/50 p-5">
                    <h3 class="text-foreground text-lg font-bold leading-tight tracking-tight flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary">analytics</span>
                        Estadísticas
                    </h3>
                    <dl class="flex flex-col gap-3">
                        <div class="flex items-center justify-between">
                            <dt class="text-sm font-medium text-muted-foreground">Publicaciones</dt>
                            <dd class="text-2xl font-bold text-foreground">{{ usuario.total_publicaciones or 0
                                }}</dd>
                        </div>
                        <div class="flex items-center justify-between">
                            <dt class="text-sm font-medium text-muted-foreground">Comentarios</dt>
                            <dd class="text-2xl font-bold text-foreground">{{ usuario.total_comentarios or 0 }}
                            </dd>
                        </div>
                        <div class="flex items-center justify-between">
                            <dt class="text-sm font-medium text-muted-foreground">Reviews</dt>
                            <dd class="text-2xl font-bold text-foreground">{{ usuario.total_reviews or 0 }}</dd>
                        </div>
                        <div class="flex items-center justify-between">
                            <dt class="text-sm font-medium text-muted-foreground">Seguidores</dt>
                            <dd class="text-2xl font-bold text-foreground">{{ usuario.total_seguidores or 0 }}
                            </dd>
                        </div>
                    </dl>
                </div>

                <!-- Redes Sociales -->
                {% if usuario.twitter_url or usuario.facebook_url or usuario.instagram_url or
                usuario.linkedin_url %}
                <div class="flex flex-col gap-4 rounded-lg bg-card/50 border border-border/50 p-5">
                    <h3 class="text-foreground text-lg font-bold leading-tight tracking-tight flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary">share</span>
                        Redes Sociales
                    </h3>
                    <ul class="flex flex-col gap-3">
                        {% if usuario.twitter_url %}
                        <li class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-xl text-muted-foreground">link</span>
                            <a class="text-primary hover:underline text-sm" href="{{ usuario.twitter_url }}"
                                target="_blank">Twitter</a>
                        </li>
                        {% endif %}
                        {% if usuario.facebook_url %}
                        <li class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-xl text-muted-foreground">link</span>
                            <a class="text-primary hover:underline text-sm" href="{{ usuario.facebook_url }}"
                                target="_blank">Facebook</a>
                        </li>
                        {% endif %}
                        {% if usuario.instagram_url %}
                        <li class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-xl text-muted-foreground">link</span>
                            <a class="text-primary hover:underline text-sm" href="{{ usuario.instagram_url }}"
                                target="_blank">Instagram</a>
                        </li>
                        {% endif %}
                        {% if usuario.linkedin_url %}
                        <li class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-xl text-muted-foreground">link</span>
                            <a class="text-primary hover:underline text-sm" href="{{ usuario.linkedin_url }}"
                                target="_blank">LinkedIn</a>
                        </li>
                        {% endif %}
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
</div>
</div>
{% endblock %}