{% extends "layout/base.html" %}

{% block title %}Nueva Red Social - VOCES{% endblock %}

{% block content %}
<div class="min-h-screen bg-background">
    <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Header -->
        <div class="mb-8">
            <div class="flex items-center gap-3 mb-4">
                <a href="/redes"
                    class="inline-flex items-center text-sm text-muted-foreground hover:text-foreground transition-colors">
                    <span class="material-symbols-outlined text-base mr-1">arrow_back</span>
                    Volver
                </a>
            </div>
            <h1 class="text-3xl font-bold text-foreground">Agregar Red Social</h1>
            <p class="mt-2 text-sm text-muted-foreground">
                Elige una red social predefinida o crea una personalizada
            </p>
        </div>

        <!-- Tabs -->
        <div class="border-b border-border mb-8">
            <div class="flex gap-8">
                <button onclick="showTab('predefinida')" id="tab-predefinida"
                    class="tab-button border-b-2 border-primary text-primary py-3 px-1 text-sm font-semibold">
                    Del Catálogo
                </button>
                <button onclick="showTab('personalizada')" id="tab-personalizada"
                    class="tab-button border-b-2 border-transparent text-muted-foreground hover:text-foreground py-3 px-1 text-sm font-semibold transition-colors">
                    Personalizada
                </button>
            </div>
        </div>

        <!-- Contenido Tab Predefinida -->
        <div id="content-predefinida" class="tab-content">
            <div class="bg-card border border-border rounded-lg p-6">
                <h2 class="text-xl font-semibold mb-4">Agregar del Catálogo</h2>
                <p class="text-sm text-muted-foreground mb-4">
                    Selecciona una red social del catálogo configurado por los administradores
                </p>
                <form method="POST" action="/redes/agregar-predefinida" class="space-y-4">
                    <div>
                        <label for="tipo_red_social_id" class="block text-sm font-medium mb-2">Red Social</label>
                        <select name="tipo_red_social_id" id="tipo_red_social_id" required
                            class="w-full px-4 py-2 bg-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-ring">
                            <option value="">Selecciona una red social</option>
                            {% for tipo in tipos_disponibles %}
                            <option value="{{ tipo.id }}" data-placeholder="{{ tipo.url_placeholder }}">
                                {{ tipo.nombre }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div>
                        <label for="url_predefinida" class="block text-sm font-medium mb-2">URL de tu perfil</label>
                        <input type="url" name="url" id="url_predefinida" required placeholder="https://..."
                            class="w-full px-4 py-2 bg-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-ring">
                        <p class="mt-1 text-sm text-muted-foreground" id="placeholder-hint"></p>
                    </div>
                    <div class="flex gap-3">
                        <a href="/redes"
                            class="flex-1 px-6 py-2 border border-border rounded-lg hover:bg-muted transition-colors text-center">
                            Cancelar
                        </a>
                        <button type="submit"
                            class="flex-1 bg-primary text-primary-foreground px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors">
                            Agregar Red Social
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Contenido Tab Personalizada -->
        <div id="content-personalizada" class="tab-content hidden">
            <div class="bg-card border border-border rounded-lg p-6">
                <h2 class="text-xl font-semibold mb-4">Agregar Red Social Personalizada</h2>
                <p class="text-sm text-muted-foreground mb-4">
                    Puedes agregar cualquier red social usando iconos de
                    <a href="https://fontawesome.com/search?o=r&m=free" target="_blank"
                        class="text-primary hover:underline">Font Awesome</a>
                </p>
                <form method="POST" action="/redes/crear" class="space-y-4">
                    <div>
                        <label for="nombre" class="block text-sm font-medium mb-2">Nombre</label>
                        <input type="text" name="nombre" id="nombre" required placeholder="Ej: Mi Blog, Portfolio, etc."
                            class="w-full px-4 py-2 bg-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-ring">
                    </div>
                    <div>
                        <label for="icono" class="block text-sm font-medium mb-2">Código del Icono Font
                            Awesome</label>
                        <input type="text" name="icono" id="icono" required
                            placeholder='<i class="fa-brands fa-dev"></i>'
                            class="w-full px-4 py-2 bg-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-ring font-mono text-sm">
                        <p class="mt-1 text-sm text-muted-foreground">
                            Copia el código HTML del icono desde Font Awesome
                        </p>
                    </div>
                    <div>
                        <label for="url_personalizada" class="block text-sm font-medium mb-2">URL</label>
                        <input type="url" name="url" id="url_personalizada" required placeholder="https://..."
                            class="w-full px-4 py-2 bg-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-ring">
                    </div>
                    <div class="flex gap-3">
                        <a href="/redes"
                            class="flex-1 px-6 py-2 border border-border rounded-lg hover:bg-muted transition-colors text-center">
                            Cancelar
                        </a>
                        <button type="submit"
                            class="flex-1 bg-primary text-primary-foreground px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors">
                            Agregar Red Personalizada
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Tabs
    function showTab(tab) {
        // Ocultar todos los contenidos
        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.add('hidden');
        });

        // Remover estilos activos de todos los tabs
        document.querySelectorAll('.tab-button').forEach(button => {
            button.classList.remove('border-primary', 'text-primary');
            button.classList.add('border-transparent', 'text-muted-foreground');
        });

        // Mostrar contenido seleccionado
        document.getElementById(`content-${tab}`).classList.remove('hidden');

        // Activar tab seleccionado
        const activeTab = document.getElementById(`tab-${tab}`);
        activeTab.classList.add('border-primary', 'text-primary');
        activeTab.classList.remove('border-transparent', 'text-muted-foreground');
    }

    // Placeholder dinámico para redes predefinidas
    const selectRed = document.getElementById('tipo_red_social_id');
    const urlInput = document.getElementById('url_predefinida');
    const placeholderHint = document.getElementById('placeholder-hint');

    selectRed.addEventListener('change', function () {
        const selectedOption = this.options[this.selectedIndex];
        const placeholder = selectedOption.getAttribute('data-placeholder');
        if (placeholder) {
            urlInput.placeholder = placeholder;
            placeholderHint.textContent = `Ejemplo: ${placeholder}`;
        } else {
            urlInput.placeholder = 'https://...';
            placeholderHint.textContent = '';
        }
    });
</script>
{% endblock %}